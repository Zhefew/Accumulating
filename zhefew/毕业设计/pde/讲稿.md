老师们大家好，我今天要汇报的课题是基于深度学习的热传导方程求解

本次汇报的内容我将分三个部分进行，分别是前期调研，研究现状，以及下一步计划

先是前期调研，这一部分我将围绕热传导方程和物理信息神经网络进行展开
热 传 导 方程 也 被称 为扩 散方程，它 是 三类偏 微 分方程 中 的 核 心 组成 部 分， 
为 许 多 领域 的扩散问题 的 探 索 和 研 究 提供 了 有 力 的 工 具 ．

若要充分描述产品的发热过程，需要求解得到产品的温度分布，即为正问题；
为了更好地设计材料的导热性能，需要确定材料的导热系数，即为反问题。

本课题拟探讨基于深度学习方法的三维固体上的热传导方程，为电子器件的性能分析提供帮助


设导热系数  $k$ , 密度  $\rho$  和比热 $c$  为常数, 物体的任意小区域为  $\Delta \sigma$ . 由 $Fourier$ 定律,  $\Delta t$  内流入的热量为:ppt中1  式的等号右边 $$\left[\frac{\partial}{\partial x}\left(k \frac{\partial u}{\partial x}\right)+\frac{\partial}{\partial y}\left(k \frac{\partial u}{\partial y}\right)\right] \Delta \sigma \Delta t,$$根据热力学第一定律,物体内能的增加等于物体吸收的热量和对物体所做的功的总和 有一这个等式:$c \rho \Delta \sigma \Delta u=\left[\frac{\partial}{\partial x}\left(k \frac{\partial u}{\partial x}\right)+\frac{\partial}{\partial y}\left(k \frac{\partial u}{\partial y}\right)\right] \Delta \sigma \Delta t,$

整理得二号等式:$c \rho \frac{\Delta u}{\Delta t}=\frac{\partial}{\partial x}\left(k \frac{\partial u}{\partial x}\right)+\frac{\partial}{\partial y}\left(k \frac{\partial u}{\partial y}\right) .$
当  $\Delta t \rightarrow 0$  时, 变成3号等式$c \rho \frac{\partial u}{\partial t}=k\left(\frac{\partial^{2} u}{\partial x^{2}}+\frac{\partial^{2} u}{\partial y^{2}}\right),$
记热扩散率 $a=\sqrt{\frac{k}{c \rho}}$ , 则上式可变为四号等式也可以写成5号的形式:$$\frac{\partial u}{\partial t}=a^{2}\left(\frac{\partial^{2} u}{\partial x^{2}}+\frac{\partial^{2} u}{\partial y^{2}}\right)$$或$\frac{\partial u}{\partial t}=a^{2} \Delta u$
即为二维齐次热传导方程, 假设热源强度为  $\phi(x, y, t)$ , 那么非齐次热传导方程为六号等式:$$\frac{\partial u}{\partial t}=a^{2}\left(\frac{\partial^{2} u}{\partial x^{2}}+\frac{\partial^{2} u}{\partial y^{2}}\right)+\phi(x, y, t)$$ .


通常情况下，如果不考虑整个空间域上的热传导过程, 则必须在指定的边界条件下才能求解方程的解. 热传导方程的解具有将初始状态温度平滑的特点: 许多不同的初始状态会逐渐趋近于同一个稳定状态. 若初始条件和边界条件都是已知的, 则可以得到热传导方程的定解问题.


考虑  $n$  维热传导方程, 则有:
$$\frac{\partial u}{\partial t}=a^{2} \Delta u+\phi(\boldsymbol{x}, t)$$
其中  $\boldsymbol{x}=\left\{x_{1}, x_{2}, \ldots, x_{n}\right\} \in R^{n}$ , 且该方程满足定解条件. 即在有限区间 $\boldsymbol{x} \in[0, L]^{n}$  且  $t>0$  上满足以下初始条件和边界条件 : 
1) 初始条件:  $u(\boldsymbol{x}, 0)=f(\boldsymbol{x})$ ;
2) 边界条件:
(1) Dirichlet 边界条件:  $u(\mathbf{0}, t)=g(t)$ ;
(2) Neumann 边界条件:  $k \frac{\partial u}{\partial n}=g(x, t)$ ;
(3) Robin 边界条件:  $k \frac{\partial u}{\partial n}+a u=g(x, t)$ .




有限元法、有限体积法和边界元法等数值方法是求解热传导正问题常用的方法。

然而，这些数值方法需要对求解域进行网格离散，而网格的划分对计算结果的精度有较大的影响。

物理信息神经网络（PINN）将物理定律和先验的物理知识编码到人工神经网络中，

并用于解决许多物理问题，这种方法将偏微分方程中的偏导数直接通过自动微分算法进行数值近似

因此，PINN 与传统的数值方法不同，其不需要对求解域进行离散处理，仅需在域内布置数据点。

此外，采用PINN 求解正问题时，对样本量的需求大大减少，甚至不需要训练样本。

 对于各项同性物体的二维热传导问题, 
考虑如下一般形式的偏微分方程 (组):
$$u_{t}+\mathcal{N}[u, \lambda]=0, \quad t \in[0, T], \quad \mathbf{x} \in \Omega$$
其中  $u(t, \mathbf{x})$  为方程 (组) 的解;  $\mathcal{N}$  为参数化的非线性微分算子，  方程中可能包含一些待定参数，记为  $\lambda ; \Omega  为  \mathbb{R}^{D}$  的子集;初边值条件为:
$$\begin{array}{l}
u(0, \mathbf{x})=g(\mathbf{x}), \quad \mathbf{x} \in \Omega \\
u(t, \mathbf{x})=h(t, \mathbf{x}), \quad t \in[0, T], \quad \mathbf{x} \in \partial \Omega
\end{array}$$
假设pde问题适定，将方程左端记为  $f(t, \mathbf{x})$ , 即  $f(t, \mathbf{x}):=u_{t}+\mathcal{N}[u ; \lambda]$  。基于物理信息的神经网络 (PINN) 方法采用深度神经网络 (DNN) 预测解  $u$ , 构建一个神经网络，其输入为x，输出为u，
然后得到基于物理信息的神经网络  $f(t, \mathbf{x})$ , f和u密切相关，其中求导通过自动微分得到。

接下来需要更新网络参数，只要构建起Loss就可以跑起来，DNN的参数通过优化Loss函数得到,有如下形式的Loss函数:分为两部分，首先在一系列点上要求网络预测的u和问题的解非常接近，其次要求f趋于零，两项约束带入的点可以不同

$$\operatorname{Loss}={M S E_{u}+M S E_{f}}=\frac{1}{N_{u}} \sum_{i=1}^{N_{u}}\left|\hat{u}\left(t_{u}^{i}, \mathbf{x}_{u}^{i}\right)-u^{i}\right|^{2}+\frac{1}{N_{f}} \sum_{i=1}^{N_{f}}\left|f\left(t_{f}^{i}, \mathbf{x}_{f}^{i}\right)\right|^{2}$$
其中  $\left\{t_{u}^{i}, \mathbf{x}_{u}^{i}, u^{i}\right\}_{i=1}^{N_{u}}$  为  $u$  的标签数据点;  $\left\{t_{f}^{i}, \mathbf{x}_{f}^{i}\right\}_{i=1}^{N_{f}}$  为指定的配置点, 即要求网络在这些点上预测的残差  $f(t, \mathbf{x})$  为零。



$$对于方程u_{t}+\mathcal{N}[u]=0, \quad t \in[0, T], \quad \mathbf{x} \in \Omega$$
正问题: 方程和定解条件均已知, 除初始/边界外, 解  u  未知, 目的是求解模型

反问题: 方程或定解条件中存在未知因素, 通常有内点处  u  的信息, 目的是确定模型

在PINN框架下, 这两类问题的处理可以 “切换自如” :

对于正问题，标签数据ui只包含初边值条件上的数据点，只需要训练DNN数据
对于反问题，ui可以包括定义域范围内所有点，增加额外训练参数，都要求残差为0

$$\operatorname{Loss}=M S E_{u}+M S E_{f}=\frac{1}{N_{u}} \sum_{i=1}^{N_{u}}\left|\hat{u}^{i}-u^{i}\right|^{2}+\frac{1}{N_{f}} \sum_{i=1}^{N_{f}}\left|f\left(\hat{u}^{i}\right)\right|^{2}$$
第一部分 ：dnn和fdm
通过构建系数矩阵 ( T ) 和源项矩阵 ( B )，并求解线性方程组 ( T x = b )，实际上是在离散化这个连续的热传导方程。这种方法允许我们在给定的网格点上近似温度分布，
1.有限差分法 (FDM) 配置：
使用 FDM 设置温度矩阵，用于解决偏微分方程。
定义网格边缘的温度边界条件。
2.创建网格：
生成一个点网格，用于计算温度。
FDM 求解器：
设置系数矩阵和源项矩阵。
使用循环填充矩阵并应用边界条件。
解线性方程组以找到网格上的温度分布。
3.计算时间：
测量解线性方程所需的时间并打印。
4深度神经网络 (DNN) 构建函数：
定义一个函数来构建具有指定隐藏层数和每层神经元数量的 DNN 模型。
对隐藏层使用 tanh 激活函数。
5准备训练数据：
清除任何现有的 TensorFlow 会话。
使用之前定义的函数构建 DNN 模型。
概述模型并绘制其架构。
将数据分为训练、测试和验证集。
6训练 DNN 模型：
使用 Adam 优化器和均方误差损失函数编译模型。
在训练数据上训练模型，并在验证数据上进行验证。
在测试数据上评估模型。
7绘制训练和验证损失：
在对数尺度上绘制训练和验证损失，以可视化学习过程。

深度神经网络（DNN）模型被设计用来学习温度分布的模式。这是通过以下步骤实现的：
数据准备：
首先，使用有限差分法（FDM）计算温度分布的数值解。
然后，将计算得到的温度数据 T 与对应的网格坐标 x 和 y 结合，形成训练数据集。
模型构建：
使用 DNN_builder 函数构建一个深度神经网络，该网络有多个隐藏层和每层固定数量的神经元。
模型的输入是坐标点 (x, y)，输出是对应的温度值 T。
模型训练：
使用训练数据集（包含输入坐标和数值解的温度），通过反向传播和梯度下降算法训练 DNN 模型。
模型的目标是最小化预测温度和数值解之间的差异，通常使用均方误差（MSE）作为损失函数。
模型评估：
在训练过程中，模型在验证集上进行评估，以监控其泛化能力。
训练完成后，模型在测试集上进行最终评估，以确定其学习的准确性。





pinn和fdm
导入库：代码导入了必要的库，如os, numpy, time, pandas, tensorflow, matplotlib, scipy.stats等。
数据生成：代码使用scipy.stats.qmc模块的拉丁超立方抽样方法生成了PDE问题的边界条件（BC）数据点。
模型构建：使用TensorFlow的Keras API构建了一个深度神经网络（DNN）模型。该模型有一个输入层，多个带有’tanh’激活函数的隐藏层，以及一个输出层。
定义函数：代码定义了几个函数，如’u’用于神经网络的预测，'f’用于计算PDE残差，以及’mse’用于均方误差。
训练循环：代码运行了一个训练循环，在其中计算了使用PDE残差和均方误差的损失，然后使用Adam优化器进行反向传播。
可视化：代码使用matplotlib可视化了边界数据点、配置点和神经网络预测的结果。
有限差分法（FDM）比较：代码还包括了一个有限差分法，用于与神经网络的结果进行比较。它计算了温度分布并进行了可视化。
性能比较：代码比较了PINN和FDM方法的性能（计算时间）。
保存结果：神经网络模型被保存到文件中，各种图表被保存为图片。

，PINN（物理信息神经网络）和FDM（有限差分方法）算法比较了两个主要的量：温度分布和温度梯度的平方。

1. **温度分布**：通过绘制温度分布图，可以直观地比较两种方法解决热传导问题的效果。这些图显示了在不同的( x )和( y )坐标下，温度是如何分布的。这对于验证和比较两种方法的准确性和效果非常有用。
    
2. **温度梯度的平方**：计算了PINN和FDM解的二阶导数（梯度的梯度），这与热传导方程中的拉普拉斯算子( \nabla^2 u )相关。然后，计算了这些梯度的平方的均值，这可以用来评估解的平滑性和物理合理性。一个较低的平均平方梯度值通常意味着解更加平滑，且在物理上可能更可信。
    

这两个量的比较有助于评估和验证PINN方法相对于传统的数值方法（如FDM）在解决特定物理问题上的性能。通过这种比较，研究人员可以确定哪种方法更适合他们的特定应用场景。此外，性能比较还包括计算时间，这是评估算法效率的重要指标。在实际应用中，计算时间和资源消耗也是选择算法时必须考虑的因素。

下一步计划
首先，我需要利用类似的方法，修改现有的代码的数据结构，先对简单的三维热传导方程进行求解
另外，在此基础上，确定求解范围，并将初边值条件定下来，因为本课题希望可以为电子器件的性能分析提供帮助，故选定如下类似于mos管的形状作为求解范围

如果条件允许，且研究进展顺利，可以将三维的pinn求解结果以及求解时间和有限元方法进行对比